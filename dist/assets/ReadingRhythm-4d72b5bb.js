import{c as g,k as i,C as Ms,l as Ts,q as ks,o as d,a as r,b as s,F as I,h as V,g as W,t as a,n as p,s as v,v as P,m as R,x as Ss,y as U,z as Y}from"./index-7434e420.js";import{u as Ps,a as Cs,b as Bs}from"./useBasicTraining-c6520dac.js";import{_ as ws}from"./_plugin-vue_export-helper-c27b6911.js";const As={name:"ReadingRhythm",emits:["back"],setup(Z,{emit:t}){const C=Ps("reading-rhythm"),{isTraining:e,isPaused:x,isCompleted:$,selectedMode:n,currentTarget:c,foundCount:N,totalCount:Ie,elapsedTime:y,completionTime:Ve,errorCount:We,showHint:Re,startTraining:ss,pauseTraining:ts,resumeTraining:es,stopTraining:ns,completeTraining:Ue,updateProgress:ze,resetTraining:De}=C,{settings:q,updateSettings:je,resetSettings:Ee}=Bs(C),{stats:z,formattedStats:as,getChartData:F,getAchievementProgress:He}=Cs(C),os=g(()=>as.value);g(()=>F.value.weekly),g(()=>F.value.monthly),g(()=>z),g(()=>z.recentSessions||[]);const is=g(()=>z.achievements||[]),u=i(120),G=i(60),L=i(200),b=i(1),O=i(4),B=i(!1),f=i(!1),M=i([]),_=i(0),ls=i(-1),T=i(0),k=i(200),w=i(100),D=i(!1),ds=i([{id:"basic",name:"基础节拍训练",icon:"🎵",level:"beginner",levelText:"初级",description:"跟随固定节拍进行阅读，建立稳定的阅读节奏",bpmRange:"60-120",textType:"简单文章",duration:"10分钟",progress:75,features:["固定节拍","基础文本","节奏训练"],benefits:["建立阅读节奏","提升阅读稳定性"]},{id:"progressive",name:"渐进式训练",icon:"📈",level:"intermediate",levelText:"中级",description:"节拍速度逐渐加快，循序渐进提升阅读速度",bpmRange:"80-160",textType:"中等文章",duration:"15分钟",progress:60,features:["渐进加速","适应性训练","速度提升"],benefits:["逐步提速","适应性强"]},{id:"variable",name:"变速节拍训练",icon:"🎭",level:"advanced",levelText:"高级",description:"节拍速度随机变化，训练阅读适应性和灵活性",bpmRange:"60-180",textType:"复杂文章",duration:"20分钟",progress:40,features:["变速训练","适应性强","灵活性训练"],benefits:["提升适应性","增强灵活性"]},{id:"compound",name:"复合节拍训练",icon:"🎼",level:"expert",levelText:"专家",description:"使用复杂节拍模式，训练高级阅读节奏控制",bpmRange:"90-200",textType:"专业文章",duration:"25分钟",progress:25,features:["复合节拍","高级训练","专业文本"],benefits:["高级节奏控制","专业阅读能力"]}]),rs=i([{speed:180},{speed:195},{speed:210},{speed:225},{speed:240},{speed:255},{speed:270}]),h=Ms({averageSpeed:0,maxSpeed:0,syncAccuracy:0,duration:0,achievement:null}),cs=g(()=>M.value.length===0?0:_.value/M.value.length*100);let S=null,j=null,E=null;const vs=o=>{n.value=o},J=o=>{n.value=o,e.value=!0,x.value=!1,ms(o),H(),ss(o)},us=()=>{x.value?(es(),H()):(ts(),A())},K=()=>{A(),h.averageSpeed=T.value,h.maxSpeed=Math.max(T.value,h.maxSpeed),h.syncAccuracy=w.value,h.duration=y.value,updateStats({mode:n.value.id,duration:y.value,speed:T.value,syncAccuracy:w.value,completed:!0}),D.value=!0,ns()},ms=o=>{switch(o.id){case"basic":u.value=80,k.value=200;break;case"progressive":u.value=100,k.value=250;break;case"variable":u.value=120,k.value=300;break;case"compound":u.value=140,k.value=350;break}gs(o),_.value=0,b.value=1,w.value=100},gs=o=>{const l={basic:"这是一个基础的阅读训练文本。通过跟随节拍进行阅读，我们可以建立稳定的阅读节奏。节拍器会帮助我们保持一致的阅读速度，从而提高阅读的流畅性和效率。",progressive:"渐进式训练是一种科学的学习方法。它通过逐步增加难度和速度，让学习者能够循序渐进地提升自己的能力。在阅读训练中，我们从较慢的速度开始，然后逐渐加快，直到达到目标速度。",variable:"变速训练能够提高我们的适应能力。在实际阅读中，我们经常需要根据文本的难度和重要性来调整阅读速度。通过变速节拍训练，我们可以学会灵活地控制阅读节奏，提高阅读的效率和理解力。",compound:"复合节拍训练是高级阅读技能的重要组成部分。它结合了多种节拍模式，要求读者具备高度的注意力和协调能力。这种训练方法能够显著提升阅读的专业性和精确性，是成为高效阅读者的必经之路。"},m=l[o.id]||l.basic;M.value=m.split("")},H=()=>{f.value&&Q(),j=setInterval(()=>{_.value<M.value.length?_.value++:K()},6e4/u.value),E=setInterval(()=>{hs()},1e3)},A=()=>{S&&clearInterval(S),j&&clearInterval(j),E&&clearInterval(E)},Q=()=>{S=setInterval(()=>{B.value=!0,b.value=b.value%O.value+1,q.value.soundEnabled&&xs(),setTimeout(()=>{B.value=!1},100)},6e4/u.value)},ps=()=>{f.value=!f.value,f.value?Q():S&&clearInterval(S)},bs=()=>{b.value=1,B.value=!1},_s=o=>{const l=u.value+o;l>=G.value&&l<=L.value&&(u.value=l,e.value&&!x.value&&(A(),H()))},hs=()=>{y.value>0&&(T.value=Math.round(_.value/y.value*60))},xs=()=>{try{const o=new(window.AudioContext||window.webkitAudioContext),l=o.createOscillator(),m=o.createGain();l.connect(m),m.connect(o.destination),l.frequency.value=b.value===1?800:400,l.type="sine",m.gain.setValueAtTime(.1,o.currentTime),m.gain.exponentialRampToValueAtTime(.01,o.currentTime+.1),l.start(o.currentTime),l.stop(o.currentTime+.1)}catch(o){console.warn("无法播放节拍音效:",o)}},ys=o=>{const l=Math.floor(o/60),m=o%60;return`${l.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}`},X=()=>{D.value=!1,e.value=!1,n.value=null},fs=()=>{X(),J(n.value)};return Ts(()=>{}),ks(()=>{A()}),{isTraining:e,isPaused:x,selectedMode:n,elapsedTime:y,showCompletionModal:D,currentBPM:u,minBPM:G,maxBPM:L,currentBeat:b,beatsPerMeasure:O,beatActive:B,metronomeActive:f,currentWords:M,currentWordIndex:_,highlightedWordIndex:ls,currentSpeed:T,targetSpeed:k,syncAccuracy:w,trainingModes:ds,progressData:rs,completionStats:h,todayStats:os,achievements:is,settings:q,readingProgress:cs,selectMode:vs,startTraining:J,togglePause:us,stopTraining:K,toggleMetronome:ps,resetMetronome:bs,adjustBPM:_s,formatTime:ys,closeModal:X,restartTraining:fs}}},Is={class:"reading-rhythm-container"},Vs={key:0,class:"mode-selection"},Ws={class:"modes-grid"},Rs=["onClick"],Us={class:"mode-header"},zs={class:"mode-icon"},Ds={class:"mode-info"},js={class:"mode-name"},Es={class:"mode-description"},Hs={class:"mode-details"},Ns={class:"detail-item"},qs={class:"detail-value"},Fs={class:"detail-item"},Gs={class:"detail-value"},Ls={class:"detail-item"},Os={class:"detail-value"},Js={class:"mode-progress"},Ks={class:"progress-bar"},Qs={class:"progress-text"},Xs=["onClick"],Ys={key:1,class:"training-interface"},Zs={class:"training-header"},$s={class:"mode-info"},st={class:"mode-icon"},tt={class:"mode-name"},et={class:"training-controls"},nt={class:"metronome-section"},at={class:"metronome-display"},ot={class:"bpm-value"},it={class:"beat-counter"},lt={class:"beat-number"},dt={class:"beat-total"},rt={class:"bpm-controls"},ct=["min","max"],vt={class:"metronome-controls"},ut={class:"reading-content"},mt={class:"text-display"},gt={class:"reading-progress"},pt={class:"progress-bar"},bt={class:"progress-info"},_t={class:"training-stats"},ht={class:"stat-item"},xt={class:"stat-value"},yt={class:"stat-item"},ft={class:"stat-value"},Mt={class:"stat-item"},Tt={class:"stat-value"},kt={class:"stat-item"},St={class:"stat-value"},Pt={class:"training-settings"},Ct={class:"settings-grid"},Bt={class:"setting-card"},wt={class:"setting-item"},At={class:"range-value"},It={class:"setting-item"},Vt={class:"range-value"},Wt={class:"setting-item"},Rt={class:"range-value"},Ut={class:"setting-card"},zt={class:"setting-item"},Dt={class:"range-value"},jt={class:"setting-item"},Et={class:"setting-item"},Ht={class:"checkbox-label"},Nt={class:"setting-card"},qt={class:"setting-item"},Ft={class:"checkbox-label"},Gt={class:"setting-item"},Lt={class:"checkbox-label"},Ot={class:"setting-item"},Jt={class:"checkbox-label"},Kt={class:"statistics-section"},Qt={class:"stats-grid"},Xt={class:"stat-card"},Yt={class:"stat-content"},Zt={class:"stat-item"},$t={class:"stat-value"},se={class:"stat-item"},te={class:"stat-value"},ee={class:"stat-item"},ne={class:"stat-value"},ae={class:"stat-item"},oe={class:"stat-value"},ie={class:"stat-card"},le={class:"progress-chart"},de={class:"chart-placeholder"},re={class:"trend-line"},ce={class:"stat-card"},ve={class:"achievements"},ue={class:"achievement-icon"},me={class:"achievement-info"},ge={class:"achievement-name"},pe={class:"achievement-desc"},be={class:"modal-header"},_e={class:"modal-content"},he={class:"completion-stats"},xe={class:"stat-item"},ye={class:"stat-value"},fe={class:"stat-item"},Me={class:"stat-value"},Te={class:"stat-item"},ke={class:"stat-value"},Se={class:"stat-item"},Pe={class:"stat-value"},Ce={key:0,class:"achievement"},Be={class:"achievement-text"},we={class:"modal-actions"};function Ae(Z,t,C,e,x,$){return d(),r("div",Is,[e.isTraining?W("",!0):(d(),r("div",Vs,[t[26]||(t[26]=s("h2",null,"选择训练模式",-1)),s("div",Ws,[(d(!0),r(I,null,V(e.trainingModes,n=>{var c;return d(),r("div",{key:n.id,class:p(["mode-card",{selected:((c=e.selectedMode)==null?void 0:c.id)===n.id}]),onClick:N=>e.selectMode(n)},[s("div",Us,[s("div",zs,a(n.icon),1),s("div",Ds,[s("h3",js,a(n.name),1),s("span",{class:p(["mode-level",n.level])},a(n.levelText),3)])]),s("p",Es,a(n.description),1),s("div",Hs,[s("div",Ns,[t[23]||(t[23]=s("span",{class:"detail-label"},"节拍范围:",-1)),s("span",qs,a(n.bpmRange),1)]),s("div",Fs,[t[24]||(t[24]=s("span",{class:"detail-label"},"文本类型:",-1)),s("span",Gs,a(n.textType),1)]),s("div",Ls,[t[25]||(t[25]=s("span",{class:"detail-label"},"训练时长:",-1)),s("span",Os,a(n.duration),1)])]),s("div",Js,[s("div",Ks,[s("div",{class:"progress-fill",style:R({width:n.progress+"%"})},null,4)]),s("span",Qs,a(n.progress)+"%",1)]),s("button",{class:"start-button",onClick:Y(N=>e.startTraining(n),["stop"])}," 开始训练 ",8,Xs)],10,Rs)}),128))])])),e.isTraining?(d(),r("div",Ys,[s("div",Zs,[s("div",$s,[s("span",st,a(e.selectedMode.icon),1),s("span",tt,a(e.selectedMode.name),1)]),s("div",et,[s("button",{class:p(["control-button",{paused:e.isPaused}]),onClick:t[0]||(t[0]=(...n)=>e.togglePause&&e.togglePause(...n))},a(e.isPaused?"继续":"暂停"),3),s("button",{class:"control-button stop",onClick:t[1]||(t[1]=(...n)=>e.stopTraining&&e.stopTraining(...n))},"结束")])]),s("div",nt,[s("div",at,[s("div",{class:p(["bpm-indicator",{active:e.beatActive}])},[s("span",ot,a(e.currentBPM),1),t[27]||(t[27]=s("span",{class:"bpm-label"},"BPM",-1))],2),s("div",it,[s("span",lt,a(e.currentBeat),1),s("span",dt,"/"+a(e.beatsPerMeasure),1)])]),s("div",rt,[s("button",{class:"bpm-btn",onClick:t[2]||(t[2]=n=>e.adjustBPM(-5))},"-5"),s("button",{class:"bpm-btn",onClick:t[3]||(t[3]=n=>e.adjustBPM(-1))},"-1"),v(s("input",{type:"range","onUpdate:modelValue":t[4]||(t[4]=n=>e.currentBPM=n),min:e.minBPM,max:e.maxBPM,class:"bpm-slider"},null,8,ct),[[P,e.currentBPM]]),s("button",{class:"bpm-btn",onClick:t[5]||(t[5]=n=>e.adjustBPM(1))},"+1"),s("button",{class:"bpm-btn",onClick:t[6]||(t[6]=n=>e.adjustBPM(5))},"+5")]),s("div",vt,[s("button",{class:p(["metronome-btn",{active:e.metronomeActive}]),onClick:t[7]||(t[7]=(...n)=>e.toggleMetronome&&e.toggleMetronome(...n))},a(e.metronomeActive?"停止节拍":"开始节拍"),3),s("button",{class:"reset-btn",onClick:t[8]||(t[8]=(...n)=>e.resetMetronome&&e.resetMetronome(...n))},"重置")])]),s("div",ut,[s("div",mt,[s("div",{class:"reading-text",style:R({fontSize:e.settings.fontSize+"px"})},[(d(!0),r(I,null,V(e.currentWords,(n,c)=>(d(),r("span",{key:c,class:p(["word",{current:c===e.currentWordIndex,read:c<e.currentWordIndex,highlighted:c===e.highlightedWordIndex}])},a(n),3))),128))],4)]),s("div",gt,[s("div",pt,[s("div",{class:"progress-fill",style:R({width:e.readingProgress+"%"})},null,4)]),s("div",bt,[s("span",null,"进度: "+a(e.currentWordIndex)+"/"+a(e.currentWords.length),1),s("span",null,"速度: "+a(e.currentSpeed)+" 字/分钟",1)])])]),s("div",_t,[s("div",ht,[t[28]||(t[28]=s("span",{class:"stat-label"},"已读时间:",-1)),s("span",xt,a(e.formatTime(e.elapsedTime)),1)]),s("div",yt,[t[29]||(t[29]=s("span",{class:"stat-label"},"当前速度:",-1)),s("span",ft,a(e.currentSpeed)+" 字/分",1)]),s("div",Mt,[t[30]||(t[30]=s("span",{class:"stat-label"},"目标速度:",-1)),s("span",Tt,a(e.targetSpeed)+" 字/分",1)]),s("div",kt,[t[31]||(t[31]=s("span",{class:"stat-label"},"节拍同步:",-1)),s("span",St,a(e.syncAccuracy)+"%",1)])])])):W("",!0),s("div",Pt,[t[45]||(t[45]=s("h3",null,"训练设置",-1)),s("div",Ct,[s("div",Bt,[t[35]||(t[35]=s("h4",null,"基础设置",-1)),s("div",wt,[t[32]||(t[32]=s("label",null,"字体大小:",-1)),v(s("input",{"onUpdate:modelValue":t[9]||(t[9]=n=>e.settings.fontSize=n),type:"range",min:"12",max:"24",class:"range-input"},null,512),[[P,e.settings.fontSize,void 0,{number:!0}]]),s("span",At,a(e.settings.fontSize)+"px",1)]),s("div",It,[t[33]||(t[33]=s("label",null,"行间距:",-1)),v(s("input",{"onUpdate:modelValue":t[10]||(t[10]=n=>e.settings.lineHeight=n),type:"range",min:"1.2",max:"2.0",step:"0.1",class:"range-input"},null,512),[[P,e.settings.lineHeight,void 0,{number:!0}]]),s("span",Vt,a(e.settings.lineHeight),1)]),s("div",Wt,[t[34]||(t[34]=s("label",null,"文本宽度:",-1)),v(s("input",{"onUpdate:modelValue":t[11]||(t[11]=n=>e.settings.textWidth=n),type:"range",min:"60",max:"100",class:"range-input"},null,512),[[P,e.settings.textWidth,void 0,{number:!0}]]),s("span",Rt,a(e.settings.textWidth)+"%",1)])]),s("div",Ut,[t[40]||(t[40]=s("h4",null,"节拍设置",-1)),s("div",zt,[t[36]||(t[36]=s("label",null,"起始BPM:",-1)),v(s("input",{"onUpdate:modelValue":t[12]||(t[12]=n=>e.settings.startBPM=n),type:"range",min:"60",max:"200",class:"range-input"},null,512),[[P,e.settings.startBPM,void 0,{number:!0}]]),s("span",Dt,a(e.settings.startBPM),1)]),s("div",jt,[t[38]||(t[38]=s("label",null,"每小节拍数:",-1)),v(s("select",{"onUpdate:modelValue":t[13]||(t[13]=n=>e.settings.beatsPerMeasure=n),class:"select-input"},t[37]||(t[37]=[s("option",{value:"2"},"2拍",-1),s("option",{value:"3"},"3拍",-1),s("option",{value:"4"},"4拍",-1),s("option",{value:"6"},"6拍",-1)]),512),[[Ss,e.settings.beatsPerMeasure]])]),s("div",Et,[s("label",Ht,[v(s("input",{"onUpdate:modelValue":t[14]||(t[14]=n=>e.settings.soundEnabled=n),type:"checkbox",class:"checkbox-input"},null,512),[[U,e.settings.soundEnabled]]),t[39]||(t[39]=s("span",{class:"checkbox-text"},"节拍音效",-1))])])]),s("div",Nt,[t[44]||(t[44]=s("h4",null,"高级设置",-1)),s("div",qt,[s("label",Ft,[v(s("input",{"onUpdate:modelValue":t[15]||(t[15]=n=>e.settings.autoProgress=n),type:"checkbox",class:"checkbox-input"},null,512),[[U,e.settings.autoProgress]]),t[41]||(t[41]=s("span",{class:"checkbox-text"},"自动进度",-1))])]),s("div",Gt,[s("label",Lt,[v(s("input",{"onUpdate:modelValue":t[16]||(t[16]=n=>e.settings.highlightWords=n),type:"checkbox",class:"checkbox-input"},null,512),[[U,e.settings.highlightWords]]),t[42]||(t[42]=s("span",{class:"checkbox-text"},"高亮当前词",-1))])]),s("div",Ot,[s("label",Jt,[v(s("input",{"onUpdate:modelValue":t[17]||(t[17]=n=>e.settings.showProgress=n),type:"checkbox",class:"checkbox-input"},null,512),[[U,e.settings.showProgress]]),t[43]||(t[43]=s("span",{class:"checkbox-text"},"显示进度",-1))])])])])]),s("div",Kt,[t[53]||(t[53]=s("h3",null,"训练统计",-1)),s("div",Qt,[s("div",Xt,[t[50]||(t[50]=s("h4",null,"今日表现",-1)),s("div",Yt,[s("div",Zt,[t[46]||(t[46]=s("span",{class:"stat-label"},"训练次数:",-1)),s("span",$t,a(e.todayStats.sessionsCompleted),1)]),s("div",se,[t[47]||(t[47]=s("span",{class:"stat-label"},"平均速度:",-1)),s("span",te,a(e.todayStats.averageSpeed)+" 字/分",1)]),s("div",ee,[t[48]||(t[48]=s("span",{class:"stat-label"},"最高速度:",-1)),s("span",ne,a(e.todayStats.maxSpeed)+" 字/分",1)]),s("div",ae,[t[49]||(t[49]=s("span",{class:"stat-label"},"节拍同步:",-1)),s("span",oe,a(e.todayStats.averageSync)+"%",1)])])]),s("div",ie,[t[51]||(t[51]=s("h4",null,"进步趋势",-1)),s("div",le,[s("div",de,[s("div",re,[(d(!0),r(I,null,V(e.progressData,(n,c)=>(d(),r("div",{key:c,class:"data-point",style:R({left:c/(e.progressData.length-1)*100+"%",bottom:n.speed/500*100+"%"})},null,4))),128))])])])]),s("div",ce,[t[52]||(t[52]=s("h4",null,"成就系统",-1)),s("div",ve,[(d(!0),r(I,null,V(e.achievements,n=>(d(),r("div",{key:n.id,class:p(["achievement-item",{unlocked:n.unlocked}])},[s("div",ue,a(n.icon),1),s("div",me,[s("div",ge,a(n.name),1),s("div",pe,a(n.description),1)])],2))),128))])])])]),e.showCompletionModal?(d(),r("div",{key:2,class:"modal-overlay",onClick:t[22]||(t[22]=(...n)=>e.closeModal&&e.closeModal(...n))},[s("div",{class:"completion-modal",onClick:t[21]||(t[21]=Y(()=>{},["stop"]))},[s("div",be,[t[54]||(t[54]=s("h3",null,"训练完成！",-1)),s("button",{class:"close-button",onClick:t[18]||(t[18]=(...n)=>e.closeModal&&e.closeModal(...n))},"×")]),s("div",_e,[s("div",he,[s("div",xe,[t[55]||(t[55]=s("span",{class:"stat-label"},"平均速度:",-1)),s("span",ye,a(e.completionStats.averageSpeed)+" 字/分",1)]),s("div",fe,[t[56]||(t[56]=s("span",{class:"stat-label"},"最高速度:",-1)),s("span",Me,a(e.completionStats.maxSpeed)+" 字/分",1)]),s("div",Te,[t[57]||(t[57]=s("span",{class:"stat-label"},"节拍同步:",-1)),s("span",ke,a(e.completionStats.syncAccuracy)+"%",1)]),s("div",Se,[t[58]||(t[58]=s("span",{class:"stat-label"},"训练时长:",-1)),s("span",Pe,a(e.formatTime(e.completionStats.duration)),1)])]),e.completionStats.achievement?(d(),r("div",Ce,[t[59]||(t[59]=s("div",{class:"achievement-icon"},"🏆",-1)),s("div",Be,a(e.completionStats.achievement),1)])):W("",!0)]),s("div",we,[s("button",{class:"primary-button",onClick:t[19]||(t[19]=(...n)=>e.restartTraining&&e.restartTraining(...n))},"再次训练"),s("button",{class:"secondary-button",onClick:t[20]||(t[20]=(...n)=>e.closeModal&&e.closeModal(...n))},"返回")])])])):W("",!0)])}const Ge=ws(As,[["render",Ae],["__scopeId","data-v-924be970"]]);export{Ge as default};
