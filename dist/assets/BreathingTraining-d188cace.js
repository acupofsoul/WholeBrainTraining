import{B as K}from"./BreadcrumbDropdown-7f07e8d4.js";import{m as T}from"./meditationStorage-bc872dc6.js";import{_ as F}from"./_plugin-vue_export-helper-c27b6911.js";import{i as c,c as k,j as Q,k as W,A as X,o as h,a as v,b as e,n as G,m as B,t as l,F as D,h as M,r as Y,y as Z,g as R,e as z}from"./index-e0b54b24.js";const ee={class:"breathing-guide"},te={class:"breathing-circle-container"},se={class:"inner-circle"},ae={class:"breath-text"},ne={class:"breath-counter"},oe={class:"progress-ring"},ie={class:"progress-svg",width:"200",height:"200"},le=["stroke-dashoffset"],re={class:"breathing-instructions"},ce={class:"phase-title"},ue={class:"phase-description"},de={class:"breathing-stats"},he={class:"stat-item"},pe={class:"stat-value"},ve={class:"stat-item"},ge={class:"stat-value"},me={class:"breathing-controls"},_e={class:"particles"},be={__name:"BreathingGuide",props:{pattern:{type:Object,default:()=>({inhale:4,hold:4,exhale:4,pause:1})},autoStart:{type:Boolean,default:!1},sessionDuration:{type:Number,default:300},saveProgress:{type:Boolean,default:!0}},emits:["phase-change","cycle-complete","session-complete","session-start","session-end"],setup(x,{emit:g}){const u=x,m=g,d=c(!1),n=c("inhale"),_=c(0),p=c(0),b=c(0),C=c(0),t=c(null),s=c(null);let $=null,f=null;const y=2*Math.PI*90,o=c(y),S=k(()=>u.pattern[n.value]||1),P=k(()=>({inhale:"吸气",hold:"屏息",exhale:"呼气",pause:"暂停"})[n.value]),O=k(()=>({inhale:"深深吸气",hold:"保持呼吸",exhale:"缓缓呼气",pause:"自然呼吸"})[n.value]),V=k(()=>({inhale:"通过鼻子慢慢吸气，感受空气进入肺部",hold:"轻松保持呼吸，不要用力",exhale:"通过嘴巴慢慢呼气，释放所有紧张",pause:"自然呼吸，准备下一轮循环"})[n.value]),j=()=>{d.value?I():A()},A=()=>{if(d.value=!0,C.value=Date.now(),t.value=Date.now(),s.value=`breathing_${Date.now()}`,u.saveProgress){const a={id:s.value,type:"breathing",startTime:t.value,pattern:u.pattern,duration:u.sessionDuration,status:"active"};T.saveSession(a)}N(),H(),m("session-start",{sessionId:s.value})},I=()=>{d.value=!1,clearTimeout($),clearInterval(f)},L=()=>{const a=d.value;if(d.value=!1,clearTimeout($),clearInterval(f),$=null,f=null,a&&u.saveProgress&&s.value){const i=Date.now(),r={id:s.value,type:"breathing",startTime:t.value,endTime:i,duration:Math.floor((i-t.value)/1e3),cycles:p.value,pattern:u.pattern,status:"completed"};T.updateSession(r);const w=T.getStatistics();w.breathingSessions++,w.totalBreathingTime+=r.duration,T.saveStatistics(w),m("session-end",r)}s.value=null,t.value=null},E=()=>{I(),n.value="inhale",_.value=0,p.value=0,b.value=0,o.value=y},N=()=>{const a=S.value*1e3;o.value=0,_.value=S.value;const i=setInterval(()=>{_.value--,_.value<=0&&clearInterval(i)},1e3);$=setTimeout(()=>{U()},a)},U=()=>{if(t.value&&b.value>=u.sessionDuration){q();return}const a=["inhale","hold","exhale","pause"],r=(a.indexOf(n.value)+1)%a.length;n.value=a[r],o.value=y,m("phase-change",n.value),n.value==="inhale"&&(p.value++,m("cycle-complete",p.value)),d.value&&N()},q=()=>{L(),m("session-complete",{cycles:p.value,duration:b.value,sessionId:s.value})},H=()=>{f=setInterval(()=>{b.value++},1e3)},J=a=>{const i=Math.floor(a/60),r=a%60;return`${i.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`};return Q(()=>u.pattern,()=>{d.value&&E()},{deep:!0}),W(()=>{u.autoStart&&A()}),X(()=>{I()}),(a,i)=>(h(),v("div",ee,[e("div",te,[e("div",{class:G(["breathing-circle",{inhaling:n.value==="inhale",holding:n.value==="hold",exhaling:n.value==="exhale",paused:n.value==="pause"}]),style:B({"--inhale-duration":`${x.pattern.inhale}s`,"--hold-duration":`${x.pattern.hold}s`,"--exhale-duration":`${x.pattern.exhale}s`,"--pause-duration":`${x.pattern.pause||1}s`})},[e("div",se,[e("div",ae,l(P.value),1),e("div",ne,l(_.value),1)]),(h(),v(D,null,M(3,r=>e("div",{class:"ripple",key:r,style:B({"--delay":`${r*.5}s`})},null,4)),64))],6),e("div",oe,[(h(),v("svg",ie,[i[0]||(i[0]=e("circle",{class:"progress-background",cx:"100",cy:"100",r:"90",fill:"none",stroke:"rgba(255, 255, 255, 0.2)","stroke-width":"4"},null,-1)),e("circle",{class:"progress-bar",cx:"100",cy:"100",r:"90",fill:"none",stroke:"#4CAF50","stroke-width":"4","stroke-linecap":"round","stroke-dasharray":y,"stroke-dashoffset":o.value,style:B({transition:d.value?`stroke-dashoffset ${S.value}s linear`:"none"})},null,12,le)]))])]),e("div",re,[e("h3",ce,l(O.value),1),e("p",ue,l(V.value),1),e("div",de,[e("div",he,[i[1]||(i[1]=e("span",{class:"stat-label"},"当前轮次",-1)),e("span",pe,l(p.value),1)]),e("div",ve,[i[2]||(i[2]=e("span",{class:"stat-label"},"总时长",-1)),e("span",ge,l(J(b.value)),1)])])]),e("div",me,[e("button",{class:"control-btn primary",onClick:j},l(d.value?"暂停":"开始"),1),e("button",{class:"control-btn secondary",onClick:E}," 重置 ")]),e("div",_e,[(h(),v(D,null,M(20,r=>e("div",{key:r,class:"particle",style:B({"--delay":`${Math.random()*10}s`,"--duration":`${5+Math.random()*10}s`,"--x":`${Math.random()*100}%`,"--y":`${Math.random()*100}%`})},null,4)),64))])]))}},fe=F(be,[["__scopeId","data-v-aca509cb"]]);const ye={class:"breathing-training-container"},xe={key:1},$e={class:"page-header"},Se={class:"header-background"},Te={class:"breathing-animation"},ke={class:"breathing-modes"},Be={class:"modes-grid"},Ce=["onClick"],Ie={class:"mode-icon"},we={class:"mode-pattern"},De={class:"pattern-value"},Me={class:"mode-duration"},Pe={class:"duration-value"},Ae={class:"mode-age"},Ee={class:"age-value"},Ne={__name:"BreathingTraining",setup(x){const g=c(null),u=c(null),m=t=>{console.log("Phase changed:",t)},d=t=>{console.log("Cycle completed:",t)},n=t=>{u.value=t,console.log("Session started:",t)},_=t=>{console.log("Session ended:",t)},p=t=>{console.log("Session completed:",t)},b=t=>{g.value=t,console.log("选择呼吸模式:",t.name)},C=c([{id:1,name:"基础呼吸",icon:"🌱",description:"简单的深呼吸练习，适合初学者",pattern:{inhale:4,hold:4,exhale:4,pause:1},patternText:"4-4-4 (吸气-保持-呼气)",duration:5,ageRange:"3-12岁",route:"/meditation/breathing/basic"},{id:2,name:"放松呼吸",icon:"🌙",description:"延长呼气时间，帮助深度放松",pattern:{inhale:4,hold:2,exhale:6,pause:1},patternText:"4-2-6 (吸气-保持-呼气)",duration:8,ageRange:"5-12岁",route:"/meditation/breathing/relaxation"},{id:3,name:"专注呼吸",icon:"🎯",description:"提升专注力的呼吸练习",pattern:{inhale:6,hold:2,exhale:6,pause:1},patternText:"6-2-6 (吸气-保持-呼气)",duration:10,ageRange:"7-12岁",route:"/meditation/breathing/focus"}]);return(t,s)=>{var f,y;const $=Y("router-view");return h(),v("div",ye,[t.$route.path==="/meditation/breathing"?(h(),Z(K,{key:0,"main-title":"冥想训练","main-path":"/meditation","current-title":"呼吸训练","sibling-modules":[{title:"引导冥想",path:"/meditation/guided"},{title:"呼吸训练",path:"/meditation/breathing"},{title:"脑波生成器",path:"/meditation/brainwave-generator"},{title:"节拍器",path:"/meditation/metronome"},{title:"想象力训练",path:"/meditation/visualization"},{title:"正念训练",path:"/meditation/mindfulness"}]})):R("",!0),t.$route.path==="/meditation/breathing"?(h(),v("div",xe,[e("div",$e,[e("div",Se,[e("div",Te,[z(fe,{pattern:((f=g.value)==null?void 0:f.pattern)||{inhale:4,hold:4,exhale:4,pause:1},"session-duration":(y=g.value)!=null&&y.duration?g.value.duration*60:300,"auto-start":!1,"save-progress":!0,onPhaseChange:m,onCycleComplete:d,onSessionStart:n,onSessionEnd:_,onSessionComplete:p},null,8,["pattern","session-duration"])])]),s[0]||(s[0]=e("h1",null,"🫁 呼吸训练",-1)),s[1]||(s[1]=e("p",{class:"page-description"}," 通过有节奏的呼吸练习，帮助孩子学会调节情绪，提升专注力和放松能力。 深呼吸是冥想的基础，也是自我调节的重要技能。 ",-1))]),e("div",ke,[s[5]||(s[5]=e("h2",{class:"section-title"},"选择呼吸模式",-1)),e("div",Be,[(h(!0),v(D,null,M(C.value,o=>{var S;return h(),v("div",{key:o.id,class:G(["mode-card",{selected:((S=g.value)==null?void 0:S.id)===o.id}]),onClick:P=>b(o)},[e("div",Ie,l(o.icon),1),e("h3",null,l(o.name),1),e("p",null,l(o.description),1),e("div",we,[s[2]||(s[2]=e("span",{class:"pattern-label"},"呼吸节奏：",-1)),e("span",De,l(o.patternText),1)]),e("div",Me,[s[3]||(s[3]=e("span",{class:"duration-label"},"时长：",-1)),e("span",Pe,l(o.duration)+"分钟",1)]),e("div",Ae,[s[4]||(s[4]=e("span",{class:"age-label"},"年龄：",-1)),e("span",Ee,l(o.ageRange),1)])],10,Ce)}),128))])])])):R("",!0),z($)])}}},Oe=F(Ne,[["__scopeId","data-v-6d676c08"]]);export{Oe as default};
